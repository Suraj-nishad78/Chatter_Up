<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" />
</head>
<body>
    <div id="name-container">
        <div id="home-content">
            <h1>Welcome to our <u><b>Chatter App</b></u></h1>
            <img src="https://static.vecteezy.com/system/resources/thumbnails/005/544/718/small_2x/profile-icon-design-free-vector.jpg">
        </div>
        <div id="form-data">
            <form id="input-form">
                <label for="input-name"></label>
                <input id="input-name" type="text" placeholder="Enter your name..." ><br>
                <button id="submit-name" >Submit</button>
            </form>
        </div>
    </div>
    <header id="container">
        <main id="message-panel">
            <div id="chat-box">
                <div id="notification-title">
                    <!-- <div class="notification">
                        <i class="fa-solid fa-circle"></i>
                        <span>welcome arnav</span>
                    </div>
                    <div class="user-typing">
                        arnav typing...
                    </div> -->
                </div>
                <div id="message-box">
                    <!-- Message box-1 -->
                    <div class="msg-container">
                        <div class="user-image">
                            <img src="https://img.freepik.com/premium-vector/cute-chibi-superhero-design_1046319-149433.jpg">
                        </div>
                        <div class="user-message">
                            <div class="user-name-time">
                                <p>coding ninjas</p>
                                <span>02:01</span>
                            </div>
                            <div class="message">
                                Hello learners! let's walk today.
                            </div>
                        </div>
                    </div>
                    <!-- Message box-1 -->
                    <div class="msg-container sender">
                        <div class="user-message">
                            <div class="user-name-time">
                                <p>coding ninjas</p>
                                <span>02:01</span>
                            </div>
                            <div class="message">
                                Hello learners! let's walk today.
                            </div>
                        </div>
                        <div class="user-image">
                            <img src="https://img.freepik.com/premium-vector/cute-chibi-superhero-design_1046319-149433.jpg">
                        </div>
                    </div>
                </div>                
                <div id="input-box">
                    <form id="msg-sent">
                        <input type="text" id="input-text" placeholder="Enter your message...">
                        <button type="submit">Send</button>
                    </form>
                </div>
            </div>
        </main>
        <main id="users">
            <div class="total-users">connected users </div>
                <div class="user-name">
                    <i class="fa-solid fa-circle"></i>
                    <span>coding ninjas</span>
                </div>
                <div class="user-name">
                    <i class="fa-solid fa-circle"></i>
                    <span>arnav</span>
                </div>
                <div class="user-name">
                    <i class="fa-solid fa-circle"></i>
                    <span>ankur</span>
                </div>
        </main>
    </header>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>

       let socket = io.connect('http://localhost:3000');

       const nameContainer = document.getElementById('name-container')
       const container =  document.getElementById('container')
       const inputName = document.getElementById('input-name')
       const submitName = document.getElementById('submit-name')
       const notificationTitle = document.getElementById('notification-title')
       const usersElement = document.getElementById('users')

       function hideMainContainer(){
        container.style.display = 'none'
       }

       hideMainContainer()

       submitName.addEventListener('click', (e)=>{
        e.preventDefault();

        const name = inputName.value;
        if(name.trim() === ''){
            return alert("Please enter your name...")
        }

        container.style.display = 'block'
        nameContainer.style.display = 'none'
        container.style.display = 'flex'

        socket.emit('username', name)

       })

       socket.on('notify', (message)=>{
        notificationTitle.innerHTML = ''
        const div = document.createElement('div')
        div.classList.add('notification')
        div.innerHTML = '<i class="fa-solid fa-circle"></i>'

        const span = document.createElement('span')
        span.textContent = message.text;
        div.append(span)
        notificationTitle.append(div)

       })

    //    socket.on('allUsers', (users)=>{
        
    //     const names = Object.values(users).map(user => user.name);
    //     connectedUsers(names)
    //    })


       function connectedUsers(users){
        usersElement.innerHTML = ''

        const totalUsers = document.createElement('div')
        totalUsers.classList.add('total-users')
        totalUsers.textContent = `Connected users ${users.length}`

        const userNames = document.createElement('div')
        userNames.classList.add('user-name')

        users.forEach(name => {
            const pTag = document.createElement('p')
            const span = document.createElement('span')
            span.innerHTML = '<i class="fa-solid fa-circle"></i>'
            pTag.append(span)
            pTag.textContent = name;
            userNames.append(pTag) 
        });

        usersElement.append(totalUsers, userNames)

       }

    </script>
</body>
</html>












